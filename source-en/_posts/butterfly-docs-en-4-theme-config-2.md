---
title: Butterfly document - Theme Configuration Part 2
comments: false
date: 2023-06-30 21:17:55
tags:
  - en
  - docs
  - hexo
categories:
  - Docs
  - EN
keywords: 'hexo,butterfly,theme,doc,ÊïôÁ®ã,ÊñáÊ™î,hexo-butterfly'
description:
top_img:
cover: https://jsd.012700.xyz/gh/jerryc127/CDN@m2/img/butterfly-docs-en-theme-config-two.png
abbrlink: butterfly-docs-en-theme-config-two
---

{% note orange 'fas fa-language' %}

This article is translated from ChatGPT.

{% endnote %}

{% note blue 'fas fa-bullhorn' %}

 ü¶ã Butterfly has been updated to [4.10](https://github.com/jerryc127/hexo-theme-butterfly/releases/tag/4.10).

{% endnote %}

{% note green 'fas fa-rocket' %}

 üìö  Table of Contents

{% post_link butterfly-docs-en-1-get-started ' üöÄ Get Started' %} - {% post_link butterfly-docs-en-2-theme-pages ' üìë Theme Pages' %} - {% post_link butterfly-docs-en-3-theme-config ' üìå Theme Configuration Part 1' %} - {% post_link butterfly-docs-en-4-theme-config-2 ' ‚öîÔ∏è Theme Configuration Part 2' %} - {% post_link butterfly-docs-en-5-theme-q-a ' ‚ùì Q&A' %} - {% post_link butterfly-docs-en-6-advanced-tutorial ' ‚ö°Ô∏è Advanced Tutorials' %}

{% endnote %}

***

## Math

{% tabs Math %}
<!-- tab MathJax -->

{% note warning flat %}
Do not use MathJax syntax in the headings; the TOC may not display MathJax properly and may show the MathJax code instead.
{% endnote %}

> It is recommended to use KaTeX for better rendering. There's an introduction below!

Modify your `theme configuration file`:

```yaml
mathjax:
  enable: true
  per_page: false
```

> If `per_page` is set to `true`, then Mathjax service will be loaded on every page. If set to `false`, you need to add `mathjax: true` in the Front-matter of the article to load Mathjax service for that specific article.

Next, you need to modify the default `markdown` renderer to achieve the MathJax effect.

Check out: [hexo-renderer-kramed](https://www.npmjs.com/package/hexo-renderer-kramed)

The following steps are performed in your Hexo blog directory (**not the Butterfly directory**):

1. Install the plugin

   ```bash
   npm uninstall hexo-renderer-marked --save
   npm install hexo-renderer-kramed --save
   ```

2. Configure the root configuration file of Hexo

   ```yaml
   kramed:
     gfm: true
     pedantic: false
     sanitize: false
     tables: true
     breaks: true
     smartLists: true
     smartypants: true
   ```

Result:

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-mathjax-2.jpg)

<!-- endtab -->

<!-- tab KaTeX -->

{% note warning flat %}
Do not use KaTeX syntax in the headings; the TOC cannot display KaTeX properly.
{% endnote %}

First, disable `MathJax` (if you have configured it), and then modify your `theme configuration file` to load `katex.min.css`:

```yaml
katex:
  enable: true
  # true means katex.js is loaded on every page
  # false means it is loaded on demand, and you need to add katex: true in the Markdown Front-matter of the article to load KaTeX service for that specific article.
  per_page: false
  hide_scrollbar: true
```

You do not need to add `katex.min.js` to render mathematical equations. Instead, you need to uninstall your previous Hexo markdown renderer and install other plugins.

{% subtabs katex-plugins %}

<!-- tab hexo-renderer-markdown-it „ÄêRecommended„Äë -->

Uninstall the marked plugin and install [hexo-renderer-markdown-it](https://github.com/hexojs/hexo-renderer-markdown-it):

```bash
npm un hexo-renderer-marked --save # Uninstall this if you have it
npm un hexo-renderer-kramed --save # Uninstall this if you have it

npm i hexo-renderer-markdown-it --save # Install this renderer plugin
npm install katex @renbaoshuo/markdown-it-katex # Install this katex plugin
```

Configure in the `_config.yml` of the Hexo root directory:

```yaml
markdown:
    plugins:
      - '@renbaoshuo/markdown-it-katex'
```

For other configurations, please refer to [katex official documentation](https://katex.org/docs/options.html).

<!-- endtab -->

<!-- tab hexo-renderer-markdown-it-plus -->

> Note that the Katex generated by this method does not have italics.

Uninstall the marked plugin and install the new `hexo-renderer-markdown-it-plus`:

```bash
# Replace `hexo-renderer-kramed` or `hexo-renderer-marked`, etc., the markdown renderer of Hexo that you can find in your package.json, and uninstall it.
npm un hexo-renderer-marked --save

# or

npm un hexo-renderer-kramed --save

# Then install `hexo-renderer-markdown-it-plus`
npm i @upupming/hexo-renderer-markdown-it-plus --save
```

Note that [`hexo-renderer-markdown-it-plus`](https://github.com/CHENXCHEN/hexo-renderer-markdown-it-plus) is no longer actively maintained. So, we are using [`@upupming/hexo-renderer-markdown-it-plus`](https://github.com/upupming/hexo-renderer-markdown-it-plus), which incorporates [`@neilsustc/markdown-it-katex`](https://github.com/yzhang-gh/markdown-it-katex), which is also used by the VSCode plugin [Markdown All in One](https://github.com/yzhang-gh/vscode-markdown), so we can get the latest KaTeX features like `\tag{}`.

You can also control KaTeX settings through [`@neilsustc/markdown-it-katex`](https://github.com/yzhang-gh/markdown-it-katex). All configurable options can be found at https://katex.org/docs/options.html. For example, if you want to disable the lengthy warning messages printed by KaTeX in the console, you can use the following configuration in the root directory's `_config.yml` to set `strict` to false:

```yaml
markdown_it_plus:
  plugins:
    - plugin:
      name: '@neilsustc/markdown-it-katex'
      enable: true
      options:
        strict: false
```

Of course, you can use this feature to define some commonly used `macros`.

<!-- endtab -->

{% endsubtabs %}

Because KaTeX is faster and lighter, it does not have as many features as MathJax (such as right-click context menu). For users who were using MathJax, the theme also includes KaTeX's [copy](https://github.com/KaTeX/KaTeX/tree/master/contrib/copy-tex) feature.

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-katex.gif)

<!-- endtab -->
{% endtabs %}

## Search

{% tabs search %}
<!-- tab Algolia @fab fa-algolia -->

> Remember to run hexo clean

> If you are using [hexo-algoliasearch](https://github.com/LouisBarranqueiro/hexo-algoliasearch), please configure the `title`, `permalink`, and `content` parameters in the `fields` setting.

1. You need to install [hexo-algolia](https://github.com/oncletom/hexo-algolia) or [hexo-algoliasearch](https://github.com/LouisBarranqueiro/hexo-algoliasearch) and configure them according to their respective documentation.

2. Modify the `theme configuration file`

```yaml
algolia_search:
  enable: true
  hits:
    per_page: 6
```

<!-- endtab -->

<!-- tab Local Search @fas fa-search -->

> Remember to run hexo clean

1. You need to install [hexo-generator-searchdb](https://github.com/next-theme/hexo-generator-searchdb) or [hexo-generator-search](https://github.com/PaicHyperionDev/hexo-generator-search) and configure them according to their documentation.

2. Modify the `theme configuration file`

```yaml
# Local search
local_search:
  enable: false
  # Preload the search data when the page loads.
  preload: false
  # Show top n results per article, show all results by setting to -1
  top_n_per_article: 1
  # Unescape HTML strings to the readable one.
  unescape: false
  CDN:
```

| Parameter         | Explanation                                                  |
| ----------------- | ------------------------------------------------------------ |
| enable            | Whether to enable local search                               |
| preload           | Preload: When enabled, the search file will be automatically loaded when entering the page. When disabled, the search file will only be loaded when clicking the search button. |
| top_n_per_article | Top n results per article to display, default to show the first 1 result |
| unescape          | Unescape HTML strings to the readable format                 |
| CDN               | CDN address of the search file (default to use local link)   |

<!-- endtab -->

<!-- tab DocSearch @fas fa-search -->

DocSearch is another search service provided by Algolia. For specific application and usage instructions, please refer to the [DocSearch documentation](https://docsearch.algolia.com/).

```
docsearch:
  enable: false
  appId:
  apiKey:
  indexName:
  option:
```

| Parameter | Explanation                                                  |
| --------- | ------------------------------------------------------------ |
| enable    | [Required] Whether to enable DocSearch                       |
| appId     | [Required] Your Algolia application ID                       |
| apiKey    | [Required] Your Algolia search API key                       |
| indexName | [Required] Your Algolia index name                           |
| option    | [Optional] Additional configurations for DocSearch. For specific options, please check [here](https://docsearch.algolia.com/docs/api/). |

![DocSearch](https://jsd.012700.xyz/gh/jerryc127/CDN@m2/img/hexo-theme-butterfly-docs-docsearch.png)

<!-- endtab -->

{% endtabs %}


## Share

> You can only choose one sharing service provider.

{% tabs share %}
<!-- tab Sharejs -->
If you are not familiar with [Sharejs](https://github.com/overtrue/share.js/), take a look at its description.

Modify the `theme configuration file`

```yaml
sharejs:
  enable: true
  sites: facebook,twitter,wechat,weibo,qq  # Choose the platforms you want to display
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-sharejs.png)
<!-- endtab -->

<!-- tab Addtoany -->
You can check the usage instructions on [addtoany](https://www.addtoany.com/)

```yaml
addtoany:
  enable: true
  item: facebook,twitter,wechat,sina_weibo,facebook_messenger,email,copy_link
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-addtoany.png)

<!-- endtab -->
{% endtabs %}

## Comments

{% tabs comments %}

<!-- tab General Settings -->

Starting from version 3.0.0, to enable comments, you need to fill in the desired comment system in `comments-use`.

Support for dual comment display, just configure two comment systems (the first one will be shown as default).

```yaml
comments:
  # Up to two comments system, the first will be shown as default
  # Choose: Disqus/Disqusjs/Livere/Gitalk/Valine/Waline/Utterances/Facebook Comments/Twikoo
  use: Valine,Disqus
  text: true # Display the comment name next to the button
  # lazyload: The comment system will be loaded when the comment element enters the browser's viewport.
  # If you set it to true, the comment count will be invalid
  lazyload: true
  count: true # Display comment count in top_img
  card_post_count: false # Display comment count on the Home Page
```

| Parameter       | Explanation                                                  |
| --------------- | ------------------------------------------------------------ |
| use             | Comment systems to use (Please note that up to two are supported, leave it empty if not needed)<br>*Note: Dual comments cannot be Disqus and Disqusjs together, as they share the same ID and will result in an error.* |
| text            | Whether to display the name of the comment service provider  |
| lazyload        | Whether to enable lazy load for comments. When enabled, the comment resources will only be loaded when scrolling to the comment section. (*With lazyload enabled, the comment count will not be displayed.*) |
| count           | Whether to display the comment count at the top of the article <br/> Livere, Giscus, and Utterances do not support displaying comment count. |
| card_post_count | Whether to display the comment count on the home page article cards <br/> Gitalk, Livere, Giscus, and Utterances do not support displaying comment count. |

> Single Comment

![image-20200731172506907](https://jsd.012700.xyz/gh/j

erryc127/CDN/img/hexo-theme-butterfly-docs-single-comments.png)

> Dual Comments

![image-20200731173006128](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-double-comments.png)

> Display Text

![image-20200731173006128](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-double-comments.png)

> Hide Text

![image-20200731173143712](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-double-comments-not-text.png)

<!-- endtab -->


<!-- tab Disqus -->

Register [Disqus](https://disqus.com/) and configure your own Disqus account.

Modify the `theme configuration file`:

```yaml
disqus:
  shortname:
```

![image-20201027211418161](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-disqus-new.png)

<!-- endtab -->

<!-- tab Disqusjs -->

Since Disqus cannot be accessed in mainland China, you can use Disqusjs to display comments when Disqus is inaccessible. For more details, you can refer to [Disqusjs](https://github.com/SukkaW/DisqusJS).

Modify the `theme configuration file`:

```yaml
disqusjs:
  shortname:
  apikey:
  option:
```

> When unable to access Disqus, it will be shown as:

![image-20201027212543851](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-disqusjs-new.png)

<!-- endtab -->

<!-- tab livere (LaiBili) -->

Register [LaiBili](https://livere.com/) and configure your own LaiBili settings.

Modify the `theme configuration file`:

```yaml
livere:
  uid:
```

You can find the LaiBili UID here:

![LaiBili UID](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-laibili.jpg)

![LaiBili UID 2](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-laibili_2-new.png)

<!-- endtab -->

<!-- tab Gitalk -->

Follow the instructions on [gitalk](https://github.com/gitalk/gitalk) to obtain your GitHub OAuth application's client ID and secret values. Also, check out its related configuration instructions.

Then, modify the `theme configuration file`:

```yaml
gitalk:
  client_id:
  client_secret:
  repo:
  owner:
  admin:
  option:
```

![image-20201027212704930](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-gitalk-new.png)

<!-- endtab -->

<!-- tab Valine -->

Follow the instructions on [Valine](https://github.com/xCss/Valine) to configure your LeanCloud application and view the corresponding configuration explanations.

Then, modify the `theme configuration file`:

```yaml
valine:
  appId: # leancloud application app id
  appKey: # leancloud application app key
  avatar: monsterid # gravatar style https://valine.js.org/#/avatar
  serverURLs: # This configuration is suitable for domestic custom domain name users, overseas version will be automatically detected (no need to manually fill in)
  bg: # valine background
  visitor: false
  option:
```

> After enabling "visitor," the number of visitors on the article page will be provided by Valine instead of **busuanzi**.

Starting from Valine v1.4.5, custom emojis are supported. If you need to configure them yourself, create a JSON file named `valine.json` in the Hexo working directory under `source/_data/`, which is equivalent to the configuration `emojiMaps` required by Valine. The `valine.json` configuration can be done as follows:

> valine.json

```json
{
  "tv_doge": "6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png",
  "tv_Ë¶™Ë¶™": "a8111ad55953ef5e3be3327ef94eb4a39d535d06.png",
  "tv_ÂÅ∑Á¨ë": "bb690d4107620f1c15cff29509db529a73aee261.png",
  "tv_ÂÜçË¶ã": "180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png",
  "tv_ÂÜ∑Êº†": "b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png",
  "tv_ÁôºÊÄí": "34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png",
  "tv_ÁôºË≤°": "34db290afd2963723c6eb3c4560667db7253a21a.png",
  "tv_ÂèØÊÑõ": "9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png",
  "tv_ÂêêË°Ä": "09dd16a7aa59b77baa1155d47484409624470c77.png",
  "tv_ÂëÜ": "fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png",
  "tv_ÂòîÂêê": "9f996894a39e282ccf5e66856af49483f81870f3.png",
  "tv_Âõ∞": "241ee304e44c0af029adceb294399391e4737ef2.png",
  "tv_Â£ûÁ¨ë": "1f0b87f731a671079842116e0991c91c2c88645a.png",
  "tv_Â§ß‰Ω¨": "093c1e2c490161aca397afc45573c877cdead616.png",
  "tv_Â§ßÂì≠": "23269aeb35f99daee28dda129676f6e9ea87934f.png",
  "tv_ÂßîÂ±à": "d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png",
  "tv_ÂÆ≥Áæû": "a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png",
  "tv_Â∞∑Â∞¨": "7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png",
  "tv_ÂæÆÁ¨ë": "70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png",
  "tv_ÊÄùËÄÉ": "90cf159733e558137ed20aa04d09964436f618a1.png",
  "tv_È©öÂöá": "0d15c7e2ee58e935adc6a7193ee042388adc22af.png"
}
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-valine.png)

> default_avatar

| Parameter  | Effect                                                       |
| ---------- | ------------------------------------------------------------ |
| Empty (default) | ![](https://www.gravatar.com/avatar/00000000000000000000000000000000) |
| mp           | ![](https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp) |
| identicon    | ![](https://www.gravatar.com/avatar/00000000000000000000000000000000?d=identicon) |
| monsterid    | ![](https://www.gravatar.com/avatar/00000000000000000000000000000000?d=monsterid) |
| wavatar      | ![](https://www.gravatar.com/avatar/00000000000000000000000000000000?d=wavatar) |
| retro        | ![](https://www.gravatar.com/avatar/00000000000000000000000000000000?d=retro) |
| robohash     | ![](https://www.gravatar.com/avatar/00000000000000000000000000000000?d=robohash) |
| blank        | ![](https://www.gravatar.com/avatar/00000000000000000000000000000000?d=blank&f=y) |
| 404          | ![](https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y) |

<!-- endtab -->

<!-- tab Waline -->

Waline is a comment system derived from Valine with a backend.

you can see more detail in [Waline Document](https://waline.js.org/)

To configure it, update your theme configuration file as follows:

```yaml
waline:
  serverURL: # Waline server address url
  bg: # Waline background
  pageview: false
  option:
```

> After enabling `pageview`, the number of visitors on your article pages will be provided by Waline instead of **Busuanzi**

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-valine.png)

<!-- endtab -->

<!-- tab Utterances -->

Utterances is a comment tool based on GitHub issues. It requires fewer permissions compared to Gitalk.
you can see more detail in [Utterances](https://utteranc.es/).

To configure it, update your theme configuration file as follows:

```yaml
utterances:
  repo:
  # Optional: pathname/url/title/og:title
  issue_term: pathname
  # Optional: github-light/github-dark/github-dark-orange/icy-dark/dark-blue/photon-dark
  light_theme: github-light
  dark_theme: photon-dark
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-Utterances.png)

<!-- endtab -->

<!-- tab Facebook Comments -->

`Facebook Comments` is a comment plugin provided by Facebook, which requires users to log in to Facebook to leave comments.
To configure it, update your theme configuration file as follows:

```yaml
# Facebook Comments Plugin
# https://developers.facebook.com/docs/plugins/comments/
facebook_comments:
  app_id: 
  user_id: # optional
  pageSize: 10 # The number of comments to show
  order_by: social # social/time/reverse_time
  lang: en_US # Language en_US/zh_CN/zh_TW and so on
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-butterfly-docs-facebook-comments.png)

<!-- endtab -->

<!-- tab Twikoo -->

Twikoo is a simple, secure, and backend-free static website comment system, please refer to the [Twikoo documentation](https://twikoo.js.org/quick-start.html#%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96).

You only need to fill in the obtained `envId` in the configuration file:

```yaml
twikoo:
  envId:
  region:
  visitor: false
  option:
```

| Parameter | Description                                               |
| --------- | --------------------------------------------------------- |
| envId     | Environment ID                                           |
| region    | Environment region, default is ap-shanghai. If your environment region is not Shanghai, pass this parameter. |
| visitor   | Whether to display article page views.                   |
| option    | Optional configuration.                                   |

> After enabling `visitor`, the number of visitors on your article pages will be provided by Twikoo instead of **Busuanzi**.

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-twikoo-comments.png)

<!-- endtab -->

<!-- tab Giscus -->

Giscus is a comment system based on *GitHub Discussions*.

```yaml
# Giscus
# https://giscus.app/
giscus:
  repo:
  repo_id:
  category_id:
  theme:
    light: light
    dark: dark
  option:
```

Please refer to the Giscus [documentation](https://giscus.app/zh-TW) for specific configuration details.

![](https://jsd.012700.xyz/gh/jerryc127/CDN@m2/img/hexo-theme-butterfly-docs-giscus.png)

<!-- endtab -->

<!-- tab remark42 -->

remark42 is a comment system that only supports **self-hosting**. For deployment instructions, please check [Installation | Remark42](https://remark42.com/docs/getting-started/installation/):


```yaml
remark42:
  host: # Your Host URL
  siteId: # Your Site ID
  option:
```

![](https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/hexo-butterfly-docs-remark42.png)

<!-- endtab -->

<!-- tab artalk -->

artalk is a comment system that only supports **self-hosting**. For deployment instructions, please check [Artalk | Self-Hosted Comment System](https://artalk.js.org/).

```yaml
artalk:
  server:
  site:
  visitor: false
  option:
```

![](https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/hexo-butterfly-docs-artalk.png)

<!-- endtab -->

{% endtabs %}

## Online Chat

Starting from version 3.0, the Butterfly theme comes with built-in support for various online chat tools. You can choose to enable one to facilitate communication with your visitors.

{% tabs online-chat %}

<!-- tab General Settings -->
All of these tools provide a button that can open/close the chat window. 
The theme also offers a unified chat button with special theme features that can replace the individual buttons of these tools. This chat button will appear in the bottom right corner.

To enable the chat button, modify the `theme config file`:

```yaml
# Chat Button [recommend]
# It will create a button in the bottom right corner of the website and hide the original button.
chat_btn: true
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-button.png)

To avoid affecting visitor experience, the theme provides a `chat_hide_show` configuration. When set to `true`, the original chat button will only be displayed when scrolling up, and it will be hidden when scrolling down.

```yaml
# The origin chat button is displayed when scrolling up, and the button is hidden when scrolling down.
chat_hide_show: true
```

{% note info %}
If using the built-in chat button of the tools, the button's position may overlap with the bottom right corner icon. In that case, you can adjust the position using the `rightside_bottom` configuration.
{% endnote %}
<!-- endtab -->

<!-- tab chatra -->
To configure Chatra, you need to know your `Public key`.

1. Open [Chatra](https://chatra.com/) and register an account.
2. In the `Preferences` section, you can find the `Public key`.

![Chatra Public Key](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-chatra-id.png)

Modify your `theme configuration file`:

```yaml
# chatra
# https://chatra.io/
chatra:
  enable: true
  id: xxxxxxxx
```

You can customize the appearance of `Chatra` in the `Chat Widget` settings.

![Chatra UI Settings](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-chatra-ui-settings.png)

> Demo

![Chatra Demo](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-chatra-ui-demo.png)
<!-- endtab -->

<!-- tab tidio -->
To configure Tidio, you need to know your `Public key`.

1. Open [Tidio](https://www.tidio.com/) and register an account.
2. In `Preferences > Developer`, you can find the `Public key`.

![Tidio Public Key](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-tidio-id.png)

Modify your `theme configuration file`:

```yaml
# tidio
# https://www.tidio.com/
tidio:
  enable: true
  public_key: XXXX
```

You can customize the appearance of `Tidio` in the `Channels` settings.

![Tidio Settings](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-tidio-setting.png)

> Demo

![Tidio Demo](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-tidio-demo.png)
<!-- endtab -->

<!-- tab daovoice -->
To configure Daovoice, you need to know your `app id`.

1. Open [Daovoice](http://daovoice.io/) and register an account.
2. Find your `app id`.

![Daovoice App ID](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-daovoice-appid.png)

Modify your `theme configuration file`:

```yaml
# daovoice
# http://daovoice.io/
daovoice:
  enable: true
  app_id: xxxxx
```

You can customize the appearance of `Daovoice` in the `Chat Settings`.

![Daovoice UI Settings](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-daovoice-ui.png)

> Demo

![Daovoice Demo](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-chat-daovoice-demo.png)
<!-- endtab -->

<!-- tab crisp -->
To configure Crisp, you need to know your `website ID`.

1. Open [Crisp](https://crisp.chat/en/) and register an account.
2. Find your `website ID`.

```yaml
# crisp
# https://crisp.chat/en/
crisp:
  enable: false
  website_id: xxxxxxxx
```

![Crisp Website ID](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-buttefly-docs-chat-crisp.png)

> Demo

![Crisp Demo](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-crisp-demo.png)
<!-- endtab -->

<!-- tab messenger -->
Messenger is a chat service by Facebook.

For specific setup instructions, please refer to [Facebook Chat Plugin - Messenger Platform](https://developers.facebook.com/docs/messenger-platform/discovery/facebook-chat-plugin/).

```yaml
messenger:
  enable: false
  pageID: xxxxx
  lang: zh_TW # Language en_US/zh_CN/zh_TW, and so on
```

![Messenger Demo](https://cdn.jsdelivr.net/gh/jerryc127/CDN@m2/img/hexo-butterfly-docs-messege.png)
<!-- endtab -->

{% endtabs %}

## Analytics

{% tabs Analytics %} 
<!-- tab Baidu Analytics -->
To set up Baidu Analytics:

1. Log in to the [official website](https://tongji.baidu.com/web/welcome/login) of Baidu Analytics.
2. Find your Baidu Analytics tracking code.

![Baidu Analytics Tracking Code](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-baidu-tongji.jpg)

3. Modify your `theme configuration file`:

```yaml
baidu_analytics: Your tracking code
```
<!-- endtab -->

<!-- tab Google Analytics -->
To set up Google Analytics:

1. Log in to the [official website](https://www.google.com/analytics/) of Google Analytics.
2. Find your Google Analytics tracking ID.

![Google Analytics Tracking ID](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-google-analytics.jpg)

3. Modify your `theme configuration file`:

```yaml
google_analytics: Your tracking code (usually starts with `UA-`)
```
<!-- endtab -->

<!-- tab Cloudflare Analytics -->
To set up Cloudflare Analytics:

1. Log in to the [official website](https://www.cloudflare.com/zh-tw/web-analytics/) of Cloudflare Analytics.
2. Find the `JavaScript snippet` for your website.
3. Locate your `token`.

![Cloudflare Analytics Token](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-cloudflare-analytics-id.png)

4. Modify your `theme configuration file`:

```yaml
# Cloudflare Analytics
# https://www.cloudflare.com/zh-tw/web-analytics/
cloudflare_analytics: Your token
```
<!-- endtab -->

<!-- tab Microsoft Clarity -->
To set up Microsoft Clarity:

1. Log in to the [official website](https://clarity.microsoft.com/) of Microsoft Clarity.
2. Create a `PROJECT`.
3. Find your `ID`.

![Microsoft Clarity ID](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-clarity-id.png)

4. Modify your `theme configuration file`:

```yaml
# Microsoft Clarity
# https://clarity.microsoft.com/
microsoft_clarity: Your ID
```
<!-- endtab -->

{% endtabs %}

## Advertisements

{% tabs Advertisements %}
<!-- tab Google AdSense -->
The theme has integrated Google AdSense (Auto Ads).

Modify your `theme configuration file`:

```yaml
google_adsense:
  enable: true
  auto_ads: true
  js: https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js
  client: Your_Publisher_ID
  enable_page_level_ads: true
```

Please replace `Your_Publisher_ID` with your personal identification code provided by Google AdSense.

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-google-adsense1.png)
<!-- endtab -->

<!-- tab manually inserting advertisements -->
The theme provides three locations for manually inserting advertisements: 
1. Between posts on the homepage (an advertisement appears after every three posts).
2. After the aside announcement.
3. After the post content on the article page.

To add your advertisements, fill in the HTML code in the corresponding locations in the `theme configuration file`:

```yaml
ad:
  index: '<!-- Your advertisement code for homepage posts -->'
  aside: '<!-- Your advertisement code for aside announcement -->'
  post: '<!-- Your advertisement code for article page -->'
```

For example:
```yaml
  index: <ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="xxxxxxxxxxxx" data-ad-client="ca-pub-xxxxxxxxxx" data-ad-slot="xxxxxxxxxx"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script>
```
![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-ad-post.png)
![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-ad-index.png)
<!-- endtab -->
{% endtabs %}

## Website Verification

If you need to have your website indexed by search engines, you may need to log in to the corresponding search engine's management platform and submit your website for verification. 
Each search engine will provide you with a verification code that you need to add to your website.

Modify your `theme configuration file`:

```yaml
site_verification:
  # - name: google-site-verification
  #   content: xxxxxx
  # - name: baidu-site-verification
  #   content: xxxxxxx
```

## Beautification/Effects

### Custom Theme Colors

You can customize most of the UI colors in the theme.

To make changes, modify the `theme configuration file` as follows:

> Color values must be wrapped in double quotes, like `"#000"`, not `#000`. Otherwise, it will cause an error during the build process!

```yaml
theme_color:
  enable: true
  main: "#49B1F5"
  paginator: "#00c4b6"
  button_hover: "#FF7242"
  text_selection: "#00c4b6"
  link_color: "#99a9bf"
  meta_color: "#858585"
  hr_color: "#A4D8FA"
  code_foreground: "#F47466"
  code_background: "rgba(27, 31, 35, .05)"
  toc_color: "#00c4b6"
  blockquote_padding_color: "#49b1f5"
  blockquote_background_color: "#49b1f5"
  scrollbar_color: "#49b1f5"
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-color_1.png)

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-color_2.png)

### Home Page Top Image Display Size

By default, the top image is displayed in full-screen mode, and the site-info area is centered.

```yaml
# Main Page Settings
# Default top_img is full-screen, and the site_info is in the middle
# Use default settings if you don't want to change (recommended)
index_site_info_top: # Distance between the main title and the top (e.g., 300px/300em/300rem/10%)
index_top_img_height:  # Height of the top image on the main page (e.g., 300px/300em/300rem). Percentage values are not allowed.
```

You can set `index_top_img_height` to specify the height of the top image. If you leave both settings blank, the default values will be used.

For example:

```yaml
index_top_img_height: 400px
```

This will change the top image height to 400 pixels.

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-index-top-img-setting.png)

### Text Alignment Justification

You can set the text to be aligned on both sides, except for the last line.

```markdown
# Stretches the lines so that each line has equal widthÔºàÊñáÂ≠óÂêëÂÖ©ÂÅ¥Â∞çÈΩäÔºåÂ∞çÊúÄÂæå‰∏ÄË°åÁÑ°ÊïàÔºâ
text_align_justify: true
```

> text_align_justify: false

![](https://oss.012700.xyz/butterfly/2023/10/text-align-justify-false.png)

> text_align_justify: true

![](https://oss.012700.xyz/butterfly/2023/10/text-align-justify-true.png)

### Website Background

By default, the website background color is white. You can set it to display an image or a custom color.

Modify the `theme configuration file`:

```yaml
# Image format: url(http://xxxxxx.com/xxx.jpg)
# Color format: (HEX value/RGB value/color word/gradient color)
# Leave it blank to display no background.
background:
```

*Note:* If your website's root directory is not `'/'`, you need to include your root directory path when using local images. For example, if your website is `https://yoursite.com/blog` and you want to reference an image located at `img/xx.png`, you should set `background` as `url(/blog/img/xx.png)`.

> background:'#49B202'

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-set-body-background-color.png)

> background: url(https://i.loli.net/2019/09/09/5oDRkWVKctx2b6A.png)

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-set-body-background-img.png)

### Footer Background

You can customize the background of the footer section.

Modify the `theme configuration file`:

```yaml
# Whether to display an image background for the footer (same as top_img)
footer_bg: true
```

| Value                                                      | Effect                      |
| ---------------------------------------------------------- | --------------------------- |
| Empty/false                                                | Display the default color   |
| img link                                                   | Display the image specified in the link   |
| Color (<br>HEX value - \#0000FF<br>RGB value - rgb(0,0,255)<br>Color name - orange<br>Gradient color - linear-gradient( 135deg, #E2B0FF 10%, #9F44D3 100%)<br>Ôºâ | Display the corresponding color |
| true                                                       | Display the same as `top_img` |

> true

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-footer-img.png)

### Typewriter Effect

You can add a typewriter effect to your website using the [activate-power-mode](https://github.com/disjukr/activate-power-mode) library.

Modify the `theme configuration file`:

```yaml
# Typewriter Effect (ÊâìÂ≠óÊïàÊûú)
# https://github.com/disjukr/activate-power-mode
activate_power_mode:
  enable: true
  colorful: true # open particle animation (ÂÜíÂÖâÁâπÊïà)
  shake: true #  open shake (ÊäñÂãïÁâπÊïà)
  mobile: false
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-type-animation.gif)

### Background Effects

{% tabs Background Effects %}
<!-- tab Static Ribbon -->
Beautiful ribbon background, can be set to change ribbon on each refresh or click.
Modify the `theme configuration file`.

```yaml
canvas_ribbon:
  enable: false
  size: 150
  alpha: 0.6
  zIndex: -1
  click_to_change: false  # Set to true if you want to change ribbon on each click
  mobile: false # false to disable on mobile devices, true to enable
```

Related configurations can be found at [canvas_ribbon](https://github.com/hustcc/ribbon.js)

![Static Ribbon](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-canvas-ribbon.png)
<!-- endtab -->

<!-- tab Fluttering Ribbon -->
Beautiful fluttering ribbon background that moves.
Modify the `theme configuration file`.

```yaml
canvas_fluttering_ribbon:
  enable: true
  mobile: false # false to disable on mobile devices, true to enable
```

![Fluttering Ribbon](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-canvas-ribbon-piao.gif)
<!-- endtab -->

<!-- tab Canvas Nest -->
Modify the `theme configuration file`.

```yaml
canvas_nest:
  enable: true
  color: '0,0,255' #color of lines, default: '0,0,0'; RGB values: (R,G,B).(note: use ',' to separate.)
  opacity: 0.7 # the opacity of line (0~1), default: 0.5.
  zIndex: -1 # z-index property of the background, default: -1.
  count: 99 # the number of lines, default: 99.
  mobile: false # false to disable on mobile devices, true to enable
```

![Canvas Nest](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-canvas_nest.gif)
<!-- endtab -->
{% endtabs %}

### Click Effects

{% tabs Click Effects %}
<!-- tab Fireworks @fas fa-fire-alt -->

The `zIndex` is recommended to be set to `-1` or `9999`.
- `-1` means the fireworks effect will be at the bottom.
- `9999` means the fireworks effect will be in front.

Modify the `theme configuration file`.

```yaml
fireworks:
  enable: true
  zIndex: 9999 # -1 or 9999
  mobile: false
```

![Fireworks](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-firewall.gif)
<!-- endtab -->

<!-- tab Heart @fas fa-heart -->
Modify the `theme configuration file`.

```yaml
# Click to show hearts
click_heart:
  enable: true
  mobile: false
```

![Heart](https://jsd.012700.xyz/gh/jerryc127/CDN/img/click_love.gif)
<!-- endtab -->

<!-- tab Text @fab fa-amilia -->
Modify the `theme configuration file`.

```yaml
# Click to show text, you can modify the text as you like
ClickShowText:
  enable: false
  text:
    - I
    - LOVE
    - YOU
  fontSize: 15px
  random: false # Show text randomly
  mobile: false
```

![Text](https://jsd.012700.xyz/gh/jerryc127/CDN/img/click_word.gif)
<!-- endtab -->
{% endtabs %}

### Page Beautification

Changes the styles of ol, ul, h1-h5 elements.

The `field` configuration specifies where the beautification should be applied:
- `post`: Only applies to the article pages.
- `site`: Applies to the entire site.

Modify the `theme configuration file`.

```yaml
# Page beautification
beautify:
  enable: true
  field: site # site/post
  title-prefix-icon: '\f0c1'
  title-prefix-icon-color: "#F47466"
```

`title-prefix-icon` should be filled with the Unicode of the desired Font Awesome icon.
![Font Awesome Unicode](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-fontwesome-unicode.png)

> Without beautification

![Without Beautification](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-post-beautify.png)

> With beautification

![With Beautification](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-post-beautif.png)

### Custom Fonts and Font Sizes

#### Global Font

You can set the `font-family` for the entire website.
**If you don't need to configure this, leave it blank.**

Modify the `theme configuration file`:

```yaml
# Global font settings
# Don't modify the following settings unless you know how they work
font:
  global-font-size:
  code-font-size:
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", Lato, Roboto, "PingFang SC", "Microsoft JhengHei", "Microsoft YaHei", sans-serif
  code-font-family: consolas, Menlo, "PingFang SC", "Microsoft JhengHei", "Microsoft YaHei", sans-serif
```

#### Blog Title Font

You can set the `font-family` for the blog title.
**If you don't need to configure this or don't want to use a web font, leave `font_link` blank.**

Modify the `theme configuration file`:

```yaml
# Font settings for the site title and site subtitle
# Â∑¶‰∏äËßíÁ∂≤Á´ôÂêçÂ≠ó ‰∏ªÈ†ÅÂ±Ö‰∏≠Á∂≤Á´ôÂêçÂ≠ó
blog_title_font:
  font_link: https://fonts.googleapis.com/css?family=Titillium+Web&display=swap
  font-family: Titillium Web, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft JhengHei', 'Microsoft YaHei', sans-serif
```

## Website Subtitle

You can set a subtitle or your favorite motto to be displayed on the homepage.

Modify the `theme configuration file` as follows:

```yaml
# Website Subtitle
subtitle:
  enable: false
  # Typewriter Effect
  effect: true
  startDelay: 300 # time before typing starts in milliseconds
  typeSpeed: 150 # type speed in milliseconds
  backSpeed: 50 # backspacing speed in milliseconds
  # loop
  loop: true
  # source (Use a third-party service)
  # source: false - Disable using a third-party service
  # source: 1 - Use hitokoto.cn (Simplified Chinese) https://hitokoto.cn/
  # source: 2 - Use yijuzhan.com (Simplified Chinese) http://yijuzhan.com/
  # source: 3 - Use jinrishici.com (Simplified Chinese) https://www.jinrishici.com/
  # The subtitle will first display the content from the chosen source (if any), and then show the content in the 'sub' field.
  source: false
  # If the typewriter effect is disabled, only the first line of 'sub' will be displayed as the subtitle.
  sub:
    - ‰ªäÊó•‰∫ã&#44;‰ªäÊó•Áï¢
    - Never put off till tomorrow what you can do today
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-index-subtitle.gif)


## Page Loading Animation (Preloader)

When visitors enter your website, slow loading speed may cause the top_img image to appear fragmented or incomplete, leading to waiting times. By enabling the preloader, a loading animation will be displayed, and the animation will disappear once the page has finished loading.

The Butterfly theme supports Pace.js for providing the loading animation. You can learn more about Pace.js [here](https://codebyzach.github.io/pace/).

Configure `butterfly.yml` as follows:

```yaml
# Âä†ËºâÂãïÁï´ Loading Animation
preloader:
  enable: false
  # source
  # 1. fullpage-loading
  # 2. pace (progress bar)
  source: 1
  # pace theme (see https://codebyzach.github.io/pace/)
  pace_css_url:
```

> fullpage-loading

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-preloader.gif)

## Word Count

To add the word count feature to your `Butterfly` theme, you need to follow these steps:

1. Open your hexo directory.

2. Install the `hexo-wordcount` plugin by running the following command:
   ```
   npm install hexo-wordcount --save
   ```
   or
   ```
   yarn add hexo-wordcount
   ```

3. Modify the `theme configuration file`:


```yaml
wordcount:
  enable: true
  post_wordcount: true
  min2read: true
  total_wordcount: true
```

![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-doc-word-count.png)
![](https://jsd.012700.xyz/gh/jerryc127/CDN/img/hexo-theme-butterfly-docs-wordcount-totalcount.png)

## Lightbox Plugins

{% note info %}

You can only enable one at a time.

{% endnote %}


{% tabs Lightbox Plugins %}

<!-- tab Note -->

If you do not want to enable the lightbox plugins for a specific image, you can use the HTML format to embed the image and add the `no-lightbox` class to it.

<!-- endtab -->

<!-- tab Fancybox -->
Modify the `theme configuration file` to enable Fancybox:

```yaml
# fancybox http://fancyapps.com/fancybox/3/
fancybox: true
```

![fancybox.gif](https://jsd.012700.xyz/gh/jerryc127/CDN/img/fancybox.gif)
<!-- endtab -->
<!-- tab medium_zoom -->
Modify the `theme configuration file` to enable Medium Zoom:

```yaml
medium_zoom: true
```

![medium_zoom.gif](https://jsd.012700.xyz/gh/jerryc127/CDN/img/medium_zoom.gif)
<!-- endtab -->
{% endtabs %}

## Pjax

When users click on links, Pjax updates only the parts of the page that need to be changed through AJAX, and then uses HTML5's pushState to modify the browser's URL address. This approach avoids reloading the same resources (CSS/JS) repeatedly, thereby improving the loading speed of the web page.

```yaml
# Pjax
# https://github.com/MoOx/pjax
pjax: 
  enable: true
  exclude:
    - /music/
    - /no-pjax/
```

{% note info %}

For some third-party plugins, not all of them support Pjax. You can add **web pages** to the `exclude` list to exclude them from using Pjax. Clicking on these pages will reload the entire website instead.

When using Pjax, some custom JavaScript code you've implemented might not work correctly on page transitions. You may need to reinitialize certain JavaScript functions when the page changes. Please refer to the [Pjax documentation](https://github.com/MoOx/pjax) for more details.

Additionally, after enabling Pjax, individual page-specific JavaScript and CSS files will be loaded on all pages instead of being loaded selectively.

{% endnote %}

{% note warning %}

Butterfly's Pjax feature is still in beta and may have some issues. Please be aware of the following:

- Google AdSense might report errors (e.g., auto-ads).

If you encounter any issues while using Pjax, please feel free to report bugs so they can be addressed.

{% endnote %}

## Snackbar pop-up

Enable Snackbar pop-up and customize its settings 

In the `theme configuration file`

```yaml
# Snackbar ÂΩàÁ™ó
# https://github.com/polonel/SnackBar
# position ÂΩàÁ™ó‰ΩçÁΩÆ
# ÂèØÈÅ∏ top-left / top-center / top-right / bottom-left / bottom-center / bottom-right
snackbar:
  enable: true
  position: bottom-left
  bg_light: '#49b1f5' # background color for light mode
  bg_dark: '#2d3035' # background color for dark mode
```

> Disable snackbar

![snackbar_false.gif](https://jsd.012700.xyz/gh/jerryc127/CDN/img/snackbar_false.gif)

> Enable snackbar

![snackbar_true.gif](https://jsd.012700.xyz/gh/jerryc127/CDN/img/snackbar_true.gif)


##  Instantpage

To enable Instantpage, which prefetches links when the mouse hovers over them for more than 65 milliseconds to improve loading speed, set instantpage to true to enable the feature.

In the `theme configuration file`

```yaml
# https://instant.page/
# prefetch (È†êÂä†Ëºâ)
instantpage: true
```

## Pangu

To enable the Pangu plugin, which automatically inserts a space between Chinese characters and English characters, follow these steps to modify the configuration file:

1. Open your Hexo theme configuration file.

2. Locate the `pangu` section and set `enable` to `true` to enable the plugin:

```yaml
# https://github.com/vinta/pangu.js
# Insert a space between Chinese character and English character (‰∏≠Ëã±Êñá‰πãÈñìÊ∑ªÂä†Á©∫Ê†º)
pangu:
  enable: true
  field: post # site/post
```

The `field` parameter only supports two values: `post` (only effective on the article page) and `site` (effective site-wide). Choose the appropriate value based on where you want the plugin to work. If you want it to work only on the article pages, set it to `post`; if you want it to work on the entire site, set it to `site`.

## PWA

To add Progressive Web App (PWA) features to your `Butterfly` theme, you need to follow these steps:

1. Open your Hexo directory.

2. Install the `hexo-offline` plugin using either `npm` or `yarn`:

   ```bash
   npm install hexo-offline --save
   # or
   yarn add hexo-offline
   ```

3. Create a `hexo-offline.config.cjs` file in the root directory and add the following content:

   ```js
   // offline config passed to workbox-build.
   module.exports = {
     globPatterns: ['**/*.{js,html,css,png,jpg,gif,svg,webp,eot,ttf,woff,woff2}'],
     // Static file collection. If your site uses file types like webp, add them here.
     globDirectory: 'public',
     swDest: 'public/service-worker.js',
     maximumFileSizeToCacheInBytes: 10485760, // Cache maximum file size in bytes.
     skipWaiting: true,
     clientsClaim: true,
     runtimeCaching: [ // If you need to load CDN resources, configure this option. If not, you can skip this.
       // CDNs - should be CacheFirst, since they should be used specific versions so should not change
       {
         urlPattern: /^https:\/\/cdn\.example\.com\/.*/, // Replace with your URL
         handler: 'CacheFirst'
       }
     ]
   }
   ```

   For more details, refer to the official documentation of [hexo-offline](https://github.com/JLHwung/hexo-offline).

4. In the `theme configuration file`, enable the PWA option:

   ```yaml
   pwa:
     enable: true
     manifest: /img/pwa/manifest.json
     apple_touch_icon: /img/pwa/apple-touch-icon.png
     favicon_32_32: /img/pwa/32.png
     favicon_16_16: /img/pwa/16.png
     mask_icon: /img/pwa/safari-pinned-tab.svg
   ```

5. Create a `manifest.json` file in the `source/` directory:

   ```json
   {
       "name": "string",
       "short_name": "Junzhou",
       "theme_color": "#49b1f5",
       "background_color": "#49b1f5",
       "display": "standalone",
       "scope": "/",
       "start_url": "/",
       "icons": [
           {
             "src": "images/pwaicons/36.png",
             "sizes": "36x36",
             "type": "image/png"
           },
           {
               "src": "images/pwaicons/48.png",
             "sizes": "48x48",
             "type": "image/png"
           },
           {
             "src": "images/pwaicons/72.png",
             "sizes": "72x72",
             "type": "image/png"
           },
           {
             "src": "images/pwaicons/96.png",
             "sizes": "96x96",
             "type": "image/png"
           },
           {
             "src": "images/pwaicons/144.png",
             "sizes": "144x144",
             "type": "image/png"
           },
           {
             "src": "images/pwaicons/192.png",
             "sizes": "192x192",
             "type": "image/png"
           },
           {
               "src": "images/pwaicons/512.png",
               "sizes": "512x512",
               "type": "image/png"
             }
         ],
         "splash_pages": null
     }
   ```

   You can also quickly generate a `manifest.json` using [Web App Manifest](https://app-manifest.firebaseapp.com/). (Web App Manifest requires at least one 512x512 pixel icon.)

6. To check if the PWA configuration is working correctly, you can use the `Lighthouse` Chrome plugin:

   - Open your blog page.
   - Launch the `Lighthouse` plugin (the plugin requires at least one 512x512 pixel icon).

For more information about Progressive Web Apps (PWA) and details on how to implement them, please refer to [Google Tools for Web Developers](https://developers.google.com/web/tools/lighthouse/audits/address-bar).

## Open Graph

To add Open Graph meta data to the `<head>` section of your website, including information such as thumbnail image, title, time, and more, you can modify your `theme configuration file` as follows:

```yaml
# Open graph meta tags
# https://developers.facebook.com/docs/sharing/webmasters/
Open_Graph_meta:
  enable: true
  option:
    # twitter_card:
    # twitter_image:
    # twitter_id:
    # twitter_site:
    # google_plus:
    # fb_admins:
    # fb_app_id:
```

## CSS Prefix

The `css_prefix` option is used to automatically add vendor prefixes to certain CSS properties to ensure compatibility with different browsers. Enabling this option will increase the CSS file size by approximately 20%.

To enable the `css_prefix` option, modify your `theme configuration file` as follows:

```yaml
# Add the vendor prefixes to ensure compatibility
css_prefix: true
```
## Inject

> Supported in version 2.3.0 and above

It allows you to add additional JavaScript, CSS, meta tags, and other content to your website. You can add these elements either to the `head` (before the closing `</body>` tag) or to the `bottom` (before the closing `</html>` tag). Please ensure that you add content in standard HTML format.

For example, to add custom CSS and a JavaScript file, you can use the following configuration in your theme configuration file:

```yaml
inject:
  head:
    - <link rel="stylesheet" href="/self.css">
  bottom:
    - <script src="xxxx"></script>
```

Please note: If your website's root directory is not '/', and you are using local images, you need to add your root directory path. For instance, if your website is `https://yoursite.com/blog`, and you want to reference `css/xx.css`, then you should set it as `<link rel="stylesheet" href="/blog/css/xx.css">`.

## CDN

The last part of the configuration file is the CDN (Content Delivery Network) section. It contains links to the files that the theme references. 
You can customize the CDN settings, but it's essential to ensure that the links are accessible after configuration.

```yaml
CDN:
  # The CDN provider of internal scripts (‰∏ªÈ°åÂÖßÈÉ® js ÁöÑ cdn ÈÖçÁΩÆ)
  # option: local/jsdelivr/unpkg/cdnjs/custom
  # Dev version can only choose. ( devÁâàÁöÑ‰∏ªÈ°åÂè™ËÉΩË®≠ÁΩÆÁÇ∫ local )
  internal_provider: local

  # The CDN provider of third party scripts (Á¨¨‰∏âÊñπ js ÁöÑ cdn ÈÖçÁΩÆ)
  # option: local/jsdelivr/unpkg/cdnjs/custom
  # when set it to local, you need to install hexo-butterfly-extjs
  third_party_provider: jsdelivr

  # Add version number to CDN, true or false  
  version: false

  # Custom format
  # For example: https://cdn.staticfile.org/${cdnjs_name}/${version}/${min_cdnjs_file}
  custom_format:

  option:
    # abcjs_basic_js:
    # activate_power_mode:
    # algolia_js:
    # algolia_search:
    # aplayer_css:
    # aplayer_js:
    # artalk_css:
    # artalk_js:
    # blueimp_md5:
    # busuanzi:
    # canvas_fluttering_ribbon:
    # canvas_nest:
    # canvas_ribbon:
    # click_heart:
    # ClickShowText:
    # disqusjs:
    # disqusjs_css:
    # docsearch_css:
    # docsearch_js:
    # egjs_infinitegrid:
    # fancybox:
    # fancybox_css:
    # fireworks:
    # fontawesome:
    # gitalk:
    # gitalk_css:
    # giscus:
    # instantpage:
    # instantsearch:
    # katex:
    # katex_copytex:
    # lazyload:
    # local_search:
    # main:
    # main_css:
    # mathjax:
    # medium_zoom:
    # mermaid:
    # meting_js:
    # pangu:
    # prismjs_autoloader:
    # prismjs_js:
    # prismjs_lineNumber_js:
    # pjax:
    # sharejs:
    # sharejs_css:
    # snackbar:
    # snackbar_css:
    # translate:
    # twikoo:
    # typed:
    # utils:
    # valine:
    # waline_css:
    # waline_js:

```

| Parameter            | Explanation                                                   |
| -------------------- | ------------------------------------------------------------ |
| internal_provider    | Internal theme files<br />Options: local / jsdelivr / unpkg / cdnjs / custom<br />'local' for local loading, 'custom' for custom format (requires configuring `custom_format`)<br />**Note:** If using the Dev version, only 'local' can be set. |
| third_party_provider | Third-party files<br />Options: local / jsdelivr / unpkg / cdnjs / custom<br />'local' for local loading, 'custom' for custom format (requires configuring `custom_format`)<br />**Note:** If you choose 'local', you need to install the `hexo-butterfly-extjs` plugin. |
| version              | true/false to add a specified version number to CDN links    |
| custom_format        | Custom format for CDN links                                   |
| option               | Allows changing specific files here, which will override the original configuration. |

### version

### Version

If you want to modify the version number, you can do so in the 'plugins.yml' file located in the theme directory. Find the corresponding plugin and update its version number.

However, please ensure that the version number you choose is supported and available on the CDN you are using. CDN providers may not always have the latest version of a plugin immediately, so it's essential to check if your selected version is available before making the change. Using an unsupported version may lead to issues with loading the plugin or cause other compatibility problems.

### custom_format

Here are the parameters and their explanations for customizing the CDN:

| Parameter      | Explanation                                                  |
| -------------- | ------------------------------------------------------------ |
| name           | The package name on npm.                                     |
| file           | The file path on npm.                                        |
| min_file       | The compressed file path on npm.                             |
| cdnjs_name     | The package name on cdnjs.                                  |
| cdnjs_file     | The file path on cdnjs.                                     |
| min_cdnjs_file | The compressed file path on cdnjs.                          |
| version        | The version number of the plugin.                            |

Here are some of the available third-party CDN providers:

> Please ensure that the CDN you choose has the necessary third-party plugins used by your theme.

| Provider                                              | Format                                                       | Remarks     |
| ----------------------------------------------------- | ------------------------------------------------------------ | ----------- |
| [Staticfile (‰∏ÉÁâõÈõ≤)](https://www.staticfile.org/)    | https://cdn.staticfile.org/${cdnjs_name}/${version}/${min_cdnjs_file} | Sync from cdnjs |
| [BootCDN](https://www.bootcdn.cn/)                    | https://cdn.bootcdn.net/ajax/libs/${cdnjs_name}/${version}/${min_cdnjs_file} | Sync from cdnjs |
| [Baomitu (360)](https://cdn.baomitu.com/)             | Latest version: https://lib.baomitu.com/${cdnjs_name}/latest/${min_cdnjs_file}<br />Specified version: https://lib.baomitu.com/${cdnjs_name}/${version}/${min_cdnjs_file} | Sync from cdnjs |
| Elemecdn                                              | Latest version: https://npm.elemecdn.com/${name}@latest/${file}<br />Specified version: https://npm.elemecdn.com/${name}@${version}/${file} | Sync from npm |

{% btn '/posts/butterfly-docs-en-theme-question/',‚ùì Butterfly document - Q&A,far fa-hand-point-right,block green right larger %}

